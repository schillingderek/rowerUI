WindowManager:
    MainWindow:
    SecondWindow:
    ThirdWindow:

[MyLabel@Label]:
    text: ctx.text if hasattr(ctx, 'text') else ''
    color: 1,1,1,1
    markup: True
    size_hint: 0.5, 0.25
    pos_hint: {'center_x': 0.5, 'center_y': 0.5}
    canvas.before:
        Color:
            rgba: 1, 0, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size

<MainWindow>:
    name: "main"
    spinner_label: spin

    GridLayout:
        cols: 1

        BoxLayout:
            orientation: 'vertical'

            BoxLayout:
                orientation: 'horizontal'
                MyLabel:
                    text: "User: "

                BoxLayout:
                    orientation: 'horizontal'

                    AnchorLayout:
                        anchor_x: 'left'
                        AnchorLayout:
                            Spinner:
                                id: spin
                                size_hint: .8, .25
                                pos_hint: {'center': (.5, .5)}
                                on_text:
                                    print("The spinner {} has text {}".format(self, self.text))

                    Button:
                        text: "New User"
                        font_size: 16
                        size_hint: (0.5, 0.25)
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        on_release:
                            app.root.current = "third"
        BoxLayout:
            orientation: 'horizontal'
            MyLabel:
                text: "Password: "


            AnchorLayout:
                anchor_x: 'left'
                TextInput:
                    id: passw
                    multiline: False
                    size_hint: 0.9, 0.25
        Button:
            text: "Submit"
            size_hint: 0.5, 0.25
            on_release:
                app.root.current = root.check_password(spin.text, passw.text)
                root.manager.transition.direction = "left"


<SecondWindow>:
    name: "second"
    counter_label: counter

    BoxLayout:
        orientation: 'vertical'

        Button:
            text: "Go Back"
            on_release:
                app.root.current = "main"
                root.manager.transition.direction = "right"

        MyLabel:
            id: counter
            text: str(round(root.time))

<ThirdWindow>:
    name: "third"
    user_exists_label: userExists

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            orientation: 'horizontal'

            MyLabel:
                text: "Name: "

            AnchorLayout:
                anchor_x: 'left'
                TextInput:
                    id: name
                    multiline: False
                    size_hint: 0.9, 0.25

        BoxLayout:
            orientation: 'horizontal'

            MyLabel:
                text: "Password: "

            AnchorLayout:
                anchor_x: 'left'
                TextInput:
                    id: passw
                    multiline: False
                    size_hint: 0.9, 0.25

        MyLabel:
            id: userExists
            text: ""

        BoxLayout:
            orientation: 'horizontal'
            Button:
                text: "Go Back"
                on_release:
                    app.root.current = "main"
                    root.manager.transition.direction = "right"

            Button:
                text: "Submit"

                on_release:
                    if root.save_user(name.text, passw.text) == True: app.root.current = "second"
                    else: root.user_exists_error()
